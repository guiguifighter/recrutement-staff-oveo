<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entretien Staff Oveo - Edition Verre Pro</title>
    <style>
        :root {
            --blue: #00a2ff;
            --bg: #050505;
            --card: #111111;
            --text: #e0e0e0;
            --success: #00ff88;
            --danger: #ff3e3e;
            --warning: #f1c40f;
            --hint: #4da3ff;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 10px; }
        .container { width: 100%; max-width: 1000px; margin: auto; }

        .header-sticky {
            position: sticky; top: 10px; z-index: 100;
            background: rgba(17, 17, 17, 0.95); backdrop-filter: blur(10px);
            border: 2px solid var(--blue); padding: 15px; border-radius: 12px;
            display: flex; justify-content: space-around; align-items: center;
            margin-bottom: 25px; box-shadow: 0 5px 20px rgba(0, 162, 255, 0.3);
        }

        .timer-val { font-family: monospace; color: var(--warning); font-size: 1.4rem; font-weight: bold; }

        /* BOUTON VERRE PREMIUM */
        .btn-glass {
            display: none;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.8rem;
            transition: 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .btn-glass:hover { background: rgba(255, 255, 255, 0.2); border-color: var(--blue); box-shadow: 0 0 15px rgba(0, 162, 255, 0.3); }

        .admin-mode .btn-glass { display: block; }

        .section { background: var(--card); padding: 20px; border-radius: 12px; margin-bottom: 25px; border: 1px solid #222; position: relative; }
        h2 { color: var(--blue); font-size: 1.1rem; border-left: 4px solid var(--blue); padding-left: 15px; text-transform: uppercase; margin-bottom: 20px; }

        .q-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        @media (max-width: 850px) { .q-grid { grid-template-columns: 1fr; } }

        .q-box { background: #1a1a1a; padding: 15px; border-radius: 8px; border: 1px solid #333; position: relative; display: flex; flex-direction: column; }
        .q-text { font-size: 0.9rem; color: #fff; margin-bottom: 5px; font-weight: bold; padding-right: 40px; }
        .ans-hint { font-size: 0.8rem; color: var(--hint); margin-bottom: 12px; font-style: italic; background: rgba(0, 162, 255, 0.05); padding: 5px; border-radius: 4px; }

        .pts-bubble { position: absolute; top: 10px; right: 10px; font-size: 0.65rem; color: var(--blue); border: 1px solid var(--blue); padding: 2px 5px; border-radius: 10px; }

        .btn-group { display: flex; gap: 10px; }
        .btn-check { flex: 1; padding: 10px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; background: #252525; color: #666; transition: 0.2s; }
        .btn-check.correct.active { background: var(--success); color: #000; }
        .btn-check.wrong.active { background: var(--danger); color: white; }

        /* ADMIN CONTROLS */
        .admin-controls { display: none; margin-bottom: 10px; gap: 5px; }
        .admin-mode .admin-controls { display: flex; }
        .btn-admin { background: #222; color: #fff; border: 1px solid #444; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 0.7rem; }
        .btn-move { background: var(--blue); color: #000; border: none; font-weight: bold; }

        .btn-add-sec { display: none; background: var(--blue); color: #000; font-weight: bold; margin-bottom: 10px; width: 100%; padding: 10px; border-radius: 8px; cursor: pointer; border: none; }

        #modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); z-index: 2000; justify-content: center; align-items: center; }
        .modal { background: #111; border: 2px solid var(--blue); border-radius: 15px; width: 90%; max-width: 450px; padding: 25px; }
        .modal input { width: 100%; background: #000; border: 1px solid #444; color: #fff; padding: 10px; margin-bottom: 10px; border-radius: 5px; box-sizing: border-box;}
        
        .actions { display: flex; gap: 10px; margin-bottom: 50px; }
        .btn-gen { flex: 2; background: var(--blue); color: white; border: none; padding: 20px; border-radius: 10px; font-weight: bold; cursor: pointer; }
        .btn-copy { flex: 1; background: #333; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; }

        #report { display: none; background: #fff; color: #000; padding: 25px; border-radius: 10px; font-family: monospace; white-space: pre-wrap; margin-bottom: 50px; border-left: 10px solid var(--blue); }
    </style>
</head>
<body>

<div class="container">
    <h1>ENTRETIEN STAFF OVEO</h1>

    <div class="header-sticky">
        <div style="text-align:center"><div id="timer" class="timer-val">00:00</div></div>
        <div style="text-align:center">
            <div id="score" style="font-size: 2.2rem; font-weight: 900; color: var(--blue);">0 / 50</div>
            <div id="status" style="font-size: 0.8rem; font-weight: bold; color: #555;">EN ATTENTE</div>
        </div>
        <div style="display: flex; gap: 8px; align-items: center;">
            <button id="btn-save" class="btn-glass" onclick="saveToStorage()">üíæ Enregistrer</button>
            <button onclick="toggleAdmin()" style="background:#222; border:1px solid var(--blue); color:var(--blue); border-radius:5px; cursor:pointer; padding:8px;">‚öôÔ∏è CONFIG</button>
            <button onclick="resetApp()" style="background:#222; border:1px solid var(--danger); color:var(--danger); border-radius:5px; cursor:pointer; padding:8px;">RESET</button>
        </div>
    </div>

    <button id="add-sec-btn" class="btn-add-sec" onclick="openModal('ADD_SEC')">+ AJOUTER UNE NOUVELLE PARTIE</button>

    <div id="main-content">
        <div class="section">
            <h2>Identit√©</h2>
            <div class="q-grid">
                <input type="text" id="cand" placeholder="Pseudo du Candidat">
                <input type="text" id="recrut" placeholder="Votre Pseudo">
            </div>
        </div>
    </div>

    <div class="section">
        <h2>‚ùå OBSERVATIONS</h2>
        <textarea id="obs" style="width:100%; background:#000; color:#fff; border:1px solid #444; padding:10px; border-radius:8px;" rows="4" placeholder="D√©tails suppl√©mentaires..."></textarea>
    </div>

    <div class="actions">
        <button class="btn-gen" onclick="generateReport()">G√âN√âRER LE BILAN</button>
        <button class="btn-copy" onclick="copyReport()">COPIER</button>
    </div>

    <pre id="report"></pre>
</div>

<div id="modal-overlay">
    <div class="modal">
        <h3 id="modal-title" style="color:var(--blue); margin-top:0;">Action</h3>
        <div id="modal-inputs">
            <input type="text" id="modal-q" placeholder="Question / Titre">
            <input type="text" id="modal-a" placeholder="R√©ponse attendue">
        </div>
        <div style="display:flex; gap:10px; margin-top:20px;">
            <button onclick="confirmModalAction()" style="flex:1; background:var(--blue); border:none; padding:10px; border-radius:5px; font-weight:bold; cursor:pointer;">Confirmer</button>
            <button onclick="closeModal()" style="flex:1; background:#222; color:#fff; border:none; padding:10px; border-radius:5px; cursor:pointer;">Annuler</button>
        </div>
    </div>
</div>

<script>
    let surveyData = JSON.parse(localStorage.getItem('oveo_master_config')) || [
        { title: "PARTIE 1 : ICEBREAKER", qs: [
            {q: "Qui es-tu sur le serveur ?", a: "V√©rification identit√©/anciennet√©"},
            {q: "C'est quoi ton moment pr√©f√©r√© ?", a: "Analyse du style de jeu"},
            {q: "Solo ou Cr√©ateur ?", a: "Profil psychologique"},
            {q: "Si tu pouvais changer UNE chose ?", a: "Sens critique"},
            {q: "Joueur √©nervant ?", a: "Self-control"}
        ]},
        { title: "üèõÔ∏è Le Maire et la Politique", qs: [
            {q: "R√®glement > lois du maire ?", a: "Vrai."},
            {q: "Temps attente braquer maire ?", a: "30 minutes."},
            {q: "AFK max Maire ?", a: "10 minutes."}
        ]}
    ];

    let currentAction = null, targetIdx = { s: null, q: null }, seconds = 0;

    setInterval(() => {
        seconds++;
        let m = Math.floor(seconds/60).toString().padStart(2,'0'), s = (seconds%60).toString().padStart(2,'0');
        document.getElementById('timer').innerText = `${m}:${s}`;
    }, 1000);

    function toggleAdmin() {
        document.body.classList.toggle('admin-mode');
        document.getElementById('add-sec-btn').style.display = document.body.classList.contains('admin-mode') ? 'block' : 'none';
        renderAll();
    }

    function saveToStorage() {
        // Sauvegarde les donn√©es
        localStorage.setItem('oveo_master_config', JSON.stringify(surveyData));
        
        // Quitte le mode admin
        toggleAdmin();
        
        // Petit message de confirmation discret (optionnel car on voit le changement d'interface)
        alert("Configuration enregistr√©e et mode √©dition d√©sactiv√©.");
    }

    function moveItem(type, sIdx, qIdx, direction) {
        if (type === 'SEC') {
            const newIdx = sIdx + direction;
            if (newIdx >= 0 && newIdx < surveyData.length) {
                const temp = surveyData[sIdx];
                surveyData[sIdx] = surveyData[newIdx];
                surveyData[newIdx] = temp;
            }
        } else {
            const newIdx = qIdx + direction;
            if (newIdx >= 0 && newIdx < surveyData[sIdx].qs.length) {
                const temp = surveyData[sIdx].qs[qIdx];
                surveyData[sIdx].qs[qIdx] = surveyData[sIdx].qs[newIdx];
                surveyData[sIdx].qs[newIdx] = temp;
            }
        }
        renderAll();
    }

    function openModal(type, sIdx = null, qIdx = null) {
        currentAction = type; targetIdx = { s: sIdx, q: qIdx };
        const inputA = document.getElementById('modal-a');
        inputA.style.display = (type.includes('_Q')) ? "block" : "none";
        document.getElementById('modal-overlay').style.display = "flex";
    }

    function closeModal() { document.getElementById('modal-overlay').style.display = "none"; }

    function confirmModalAction() {
        const valQ = document.getElementById('modal-q').value;
        const valA = document.getElementById('modal-a').value;
        const s = targetIdx.s;

        if(currentAction === 'ADD_SEC' && valQ) surveyData.push({ title: valQ, qs: [] });
        if(currentAction === 'ADD_Q' && valQ) surveyData[s].qs.push({ q: valQ, a: valA });
        
        renderAll(); closeModal();
    }

    function resetApp() { if(confirm("Tout effacer ?")) { localStorage.clear(); location.reload(); } }

    function renderAll() {
        const main = document.getElementById('main-content');
        const identite = main.firstElementChild;
        main.innerHTML = ''; main.appendChild(identite);

        const totalQs = surveyData.reduce((acc, sec) => acc + sec.qs.length, 0);
        const ptsPerQ = (50 / (totalQs || 1)).toFixed(2);

        surveyData.forEach((sec, sIdx) => {
            const secDiv = document.createElement('div');
            secDiv.className = 'section';
            secDiv.innerHTML = `
                <h2>${sec.title}</h2>
                <div class="admin-controls">
                    <button class="btn-admin btn-move" onclick="moveItem('SEC', ${sIdx}, null, -1)">‚ñ≤</button>
                    <button class="btn-admin btn-move" onclick="moveItem('SEC', ${sIdx}, null, 1)">‚ñº</button>
                    <button class="btn-admin" style="color:var(--danger)" onclick="surveyData.splice(${sIdx}, 1); renderAll();">Supprimer Partie</button>
                </div>
                <div class="q-grid" id="sec-${sIdx}"></div>
                <button class="btn-admin" style="margin-top:10px; width:100%; display:${document.body.classList.contains('admin-mode')?'block':'none'}" onclick="openModal('ADD_Q', ${sIdx})">+ Ajouter Question</button>
            `;
            main.appendChild(secDiv);

            sec.qs.forEach((qObj, qIdx) => {
                const qBox = document.createElement('div');
                qBox.className = 'q-box';
                qBox.innerHTML = `
                    <span class="pts-bubble">${ptsPerQ} pts</span>
                    <span class="q-text">${qObj.q}</span>
                    <span class="ans-hint">R√©ponse : ${qObj.a}</span>
                    <div class="admin-controls">
                        <button class="btn-admin btn-move" onclick="moveItem('Q', ${sIdx}, ${qIdx}, -1)">‚ñ≤</button>
                        <button class="btn-admin btn-move" onclick="moveItem('Q', ${sIdx}, ${qIdx}, 1)">‚ñº</button>
                        <button class="btn-admin" style="color:var(--danger)" onclick="surveyData[${sIdx}].qs.splice(${qIdx}, 1); renderAll();">X</button>
                    </div>
                    <div class="btn-group">
                        <button class="btn-check correct" data-pts="${ptsPerQ}" onclick="mark(this)">OK</button>
                        <button class="btn-check wrong active" data-pts="0" onclick="mark(this)">NON</button>
                    </div>
                `;
                secDiv.querySelector('.q-grid').appendChild(qBox);
            });
        });
    }

    function mark(btn) { btn.parentElement.querySelectorAll('.btn-check').forEach(b => b.classList.remove('active')); btn.classList.add('active'); updateScore(); }
    
    function updateScore() {
        let total = 0;
        document.querySelectorAll('.btn-check.active').forEach(b => total += parseFloat(b.getAttribute('data-pts') || 0));
        const score = Math.min(50, Math.round(total));
        document.getElementById('score').innerText = `${score} / 50`;
        const st = document.getElementById('status');
        st.innerText = score >= 37 ? "ACCEPT√â" : "REFUS√â";
        st.style.color = score >= 37 ? "var(--success)" : "var(--danger)";
    }

    function generateReport() {
        let r = `‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n  BILAN STAFF OVEO - ${document.getElementById('status').innerText}\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n`;
        r += `JOUEUR : ${document.getElementById('cand').value} | NOTE : ${document.getElementById('score').innerText}\n\nD√âTAILS :\n`;
        document.querySelectorAll('.q-box').forEach(box => r += `  ${box.querySelector('.correct').classList.contains('active') ? "[OK]" : "[X]"} ${box.querySelector('.q-text').innerText}\n`);
        r += `\nOBS : ${document.getElementById('obs').value}`;
        const area = document.getElementById('report'); area.innerText = r; area.style.display = 'block';
    }

    function copyReport() { navigator.clipboard.writeText(document.getElementById('report').innerText); alert("Copi√© !"); }

    renderAll();
</script>
</body>
</html>